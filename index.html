<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¹Ù…Ø± Ø§Ù„Ø°ÙƒÙŠ v3</title>
    <style>
        body { background: #0a0a0a; color: white; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; font-family: sans-serif; }
        #clock { font-size: 60px; font-weight: bold; color: #00d4ff; font-family: monospace; text-shadow: 0 0 15px rgba(0,212,255,0.4); }
        .panel { background: #151515; padding: 20px; border-radius: 25px; border: 2px solid #00d4ff; width: 85%; max-width: 350px; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        input[type="time"] { padding: 12px; border-radius: 12px; width: 90%; font-size: 24px; margin: 10px 0; border: none; }
        .music-btn { background: #333; color: #00d4ff; padding: 8px; border-radius: 10px; display: inline-block; cursor: pointer; font-size: 12px; margin-top: 10px; border: 1px solid #00d4ff; }
        .links { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 90%; max-width: 400px; margin-top: 20px; }
        .links a { padding: 15px; color: white; text-decoration: none; border-radius: 12px; font-weight: bold; text-align: center; }
        .fb { background: #1877f2; } .ms { background: #0084ff; } .yt { background: #ff0000; } .gg { background: #4285f4; }
        #stopBtn { display: none; background: #ff4757; color: white; padding: 15px; border-radius: 50px; width: 220px; border: none; font-weight: bold; margin-top: 15px; cursor: pointer; animation: pulse 1s infinite; }
        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
    </style>
</head>
<body onclick="unlockAudio()">

    <div style="margin-bottom:10px">ğŸŒ¡ï¸ <span id="temp">24Â°C</span></div>
    <div id="clock">00:00:00</div>
    <div id="date" style="color:#888; margin-bottom:20px">Ø§Ù„ØªØ§Ø±ÙŠØ®</div>

    <div class="panel">
        <div>â° Ù…Ù†Ø¨Ù‡ Ø§Ù„ÙØ¬Ø± (Ù…Ø­ÙÙˆØ¸)</div>
        <input type="time" id="alarmTime" onchange="saveAlarm()">
        <label class="music-btn">ğŸµ Ø§Ø®ØªØ± Ø±Ù†Ø© Ù…Ù† Ø¬Ù‡Ø§Ø²Ùƒ
            <input type="file" id="musicFile" accept="audio/*" style="display:none" onchange="loadMusic(event)">
        </label>
        <p id="audioStatus" style="font-size:10px; color:#888;">Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø¬Ø§Ù‡Ø²</p>
    </div>

    <button id="stopBtn" onclick="stopAlarm()">ğŸ›‘ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ù†Ø¨Ù‡ Ø§Ù„Ø¢Ù†</button>

    <div class="links">
        <a href="https://facebook.com" class="fb">Facebook</a>
        <a href="https://messenger.com" class="ms">Messenger</a>
        <a href="https://youtube.com" class="yt">YouTube</a>
        <a href="https://google.com" class="gg">Google</a>
    </div>

    <audio id="alarmAudio" loop></audio>

    <script>
        let hasCustomMusic = false;
        let alarmActive = false;

        // ÙØªØ­ Ù‚ÙÙ„ Ø§Ù„ØµÙˆØª (Ø¶Ø±ÙˆØ±ÙŠ Ø¬Ø¯Ø§Ù‹)
        function unlockAudio() {
            window.speechSynthesis.cancel();
            document.getElementById('audioStatus').textContent = "ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¨Ù†Ø¬Ø§Ø­ âœ…";
            document.getElementById('audioStatus').style.color = "#00ff00";
        }

        function loadMusic(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('alarmAudio').src = e.target.result;
                hasCustomMusic = true;
                alert("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø±Ù†ØªÙƒ Ø§Ù„Ø®Ø§ØµØ©! ğŸµ");
            };
            reader.readAsDataURL(file);
        }

        function saveAlarm() {
            localStorage.setItem('omar_alarm_v3', document.getElementById('alarmTime').value);
        }

        function tick() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('en-GB');
            document.getElementById('date').textContent = now.toLocaleDateString('ar-EG', {weekday:'long', day:'numeric', month:'long'});

            const savedAlarm = localStorage.getItem('omar_alarm_v3');
            const currentTime = now.getHours().toString().padStart(2, '0') + ":" + now.getMinutes().toString().padStart(2, '0');

            if (savedAlarm === currentTime && now.getSeconds() === 0 && !alarmActive) {
                startAlarm();
            }
        }

        function startAlarm() {
            alarmActive = true;
            document.getElementById('stopBtn').style.display = 'block';
            
            if (hasCustomMusic) {
                document.getElementById('alarmAudio').play();
            } else {
                // ØªÙƒØ±Ø§Ø± Ø§Ù„Ù†Ø·Ù‚
                speakLoop();
            }
        }

        function speakLoop() {
            if (!alarmActive) return;
            const speech = new SpeechSynthesisUtterance("Ø¹Ù…Ø± . . . Ø¹Ù…Ø± . . . Ø§Ø³ØªÙŠÙ‚Ø¸ Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ÙØ¬Ø±");
            speech.lang = 'ar-SA';
            speech.rate = 0.7;
            speech.pitch = 0.5;
            speech.onend = function() { if(alarmActive) speakLoop(); }; // ØªÙƒØ±Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
            window.speechSynthesis.speak(speech);
        }

        function stopAlarm() {
            alarmActive = false;
            document.getElementById('alarmAudio').pause();
            window.speechSynthesis.cancel();
            document.getElementById('stopBtn').style.display = 'none';
        }

        setInterval(tick, 1000);
        const saved = localStorage.getItem('omar_alarm_v3');
        if (saved) document.getElementById('alarmTime').value = saved;
        tick();
    </script>
</body>
</html>